<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube to SEO Content Generator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .main-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            margin: 2rem auto;
            max-width: 1200px;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 20px 20px 0 0;
            text-align: center;
        }
        
        .form-section {
            padding: 2rem;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 10px;
            padding: 12px 30px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        
        .form-control, .form-select {
            border-radius: 10px;
            border: 2px solid #e9ecef;
            padding: 12px 15px;
            transition: all 0.3s ease;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 2rem;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .result-section {
            display: none;
            padding: 2rem;
            background: #f8f9fa;
            border-radius: 0 0 20px 20px;
        }
        
        .preview-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .keyword-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            margin: 2px;
            display: inline-block;
            font-size: 0.8rem;
        }
        
        .social-media-card {
            background: white;
            border-radius: 10px;
            padding: 1rem;
            margin: 0.5rem 0;
            border-left: 4px solid #667eea;
        }
        
        .platform-icon {
            width: 30px;
            height: 30px;
            margin-right: 10px;
        }
        
        .alert {
            border-radius: 10px;
            border: none;
        }
        
        .progress {
            height: 8px;
            border-radius: 10px;
            background: #e9ecef;
        }
        
        .progress-bar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="main-container">
            <!-- Header -->
            <div class="header">
                <h1><i class="fas fa-youtube"></i> YouTube to SEO Content Generator</h1>
                <p class="mb-0">유튜브 스크립트를 SEO 최적화된 블로그 포스트로 변환하세요</p>
            </div>
            
            <!-- Form Section -->
            <div class="form-section">
                <form id="conversionForm">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="youtubeUrl" class="form-label">
                                    <i class="fas fa-link"></i> YouTube URL
                                </label>
                                <input type="url" class="form-control" id="youtubeUrl" 
                                       placeholder="https://www.youtube.com/watch?v=..." required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="contentType" class="form-label">
                                    <i class="fas fa-tags"></i> 콘텐츠 유형
                                </label>
                                <select class="form-select" id="contentType">
                                    <option value="blog">블로그 포스트</option>
                                    <option value="article">기사</option>
                                    <option value="review">리뷰</option>
                                    <option value="tutorial">튜토리얼</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="scriptText" class="form-label">
                            <i class="fas fa-file-text"></i> YouTube 스크립트
                        </label>
                        <textarea class="form-control" id="scriptText" rows="10" 
                                  placeholder="유튜브 영상의 스크립트를 여기에 붙여넣으세요..." required></textarea>
                        <div class="form-text">
                            <i class="fas fa-info-circle"></i> 
                            스크립트는 YouTube Studio에서 자동 생성된 자막을 사용하거나 수동으로 입력할 수 있습니다.
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <button type="submit" class="btn btn-primary btn-lg">
                            <i class="fas fa-magic"></i> SEO 콘텐츠 생성하기
                        </button>
                    </div>
                </form>
            </div>
            
            <!-- Loading Section -->
            <div class="loading" id="loadingSection">
                <div class="spinner"></div>
                <h4>AI가 콘텐츠를 생성하고 있습니다...</h4>
                <div class="progress mt-3">
                    <div class="progress-bar" role="progressbar" style="width: 0%"></div>
                </div>
                <p class="mt-2 text-muted">잠시만 기다려주세요. 최대 1-2분 정도 소요될 수 있습니다.</p>
            </div>
            
            <!-- Result Section -->
            <div class="result-section" id="resultSection">
                <div class="row">
                    <div class="col-md-8">
                        <div class="preview-card">
                            <h4><i class="fas fa-eye"></i> 미리보기</h4>
                            <div id="contentPreview"></div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="preview-card">
                            <h4><i class="fas fa-chart-line"></i> SEO 분석</h4>
                            <div id="seoAnalysis"></div>
                        </div>
                        
                        <div class="preview-card">
                            <h4><i class="fas fa-share-alt"></i> 소셜미디어</h4>
                            <div id="socialMedia"></div>
                        </div>
                        
                        <div class="text-center">
                            <button class="btn btn-success btn-lg w-100 mb-2" onclick="downloadPackage()">
                                <i class="fas fa-download"></i> 패키지 다운로드
                            </button>
                            <button class="btn btn-outline-primary w-100" onclick="resetForm()">
                                <i class="fas fa-redo"></i> 새로 만들기
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let currentPackage = null;
        
        document.getElementById('conversionForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const youtubeUrl = document.getElementById('youtubeUrl').value;
            const scriptText = document.getElementById('scriptText').value;
            const contentType = document.getElementById('contentType').value;
            
            if (!youtubeUrl || !scriptText) {
                alert('YouTube URL과 스크립트를 모두 입력해주세요.');
                return;
            }
            
            // 로딩 시작
            showLoading();
            
            try {
                const response = await fetch('/api/convert', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        youtube_url: youtubeUrl,
                        script_text: scriptText,
                        content_type: contentType
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    currentPackage = result.package;
                    showResults(result.package);
                } else {
                    alert('오류: ' + result.error);
                }
            } catch (error) {
                alert('네트워크 오류가 발생했습니다: ' + error.message);
            } finally {
                hideLoading();
            }
        });
        
        function showLoading() {
            document.getElementById('loadingSection').style.display = 'block';
            document.getElementById('resultSection').style.display = 'none';
            
            // 프로그레스 바 애니메이션
            const progressBar = document.querySelector('.progress-bar');
            let width = 0;
            const interval = setInterval(() => {
                if (width >= 90) {
                    clearInterval(interval);
                } else {
                    width += Math.random() * 10;
                    progressBar.style.width = width + '%';
                }
            }, 500);
        }
        
        function hideLoading() {
            document.getElementById('loadingSection').style.display = 'none';
        }
        
        function showResults(package) {
            document.getElementById('resultSection').style.display = 'block';
            
            // 콘텐츠 미리보기
            const contentPreview = document.getElementById('contentPreview');
            if (package.seo_content && package.seo_content.html_content) {
                contentPreview.innerHTML = package.seo_content.html_content;
            }
            
            // SEO 분석
            const seoAnalysis = document.getElementById('seoAnalysis');
            if (package.analysis) {
                let analysisHtml = '';
                
                if (package.analysis.main_keywords) {
                    analysisHtml += '<h6>주요 키워드:</h6>';
                    package.analysis.main_keywords.forEach(keyword => {
                        analysisHtml += `<span class="keyword-badge">${keyword}</span>`;
                    });
                    analysisHtml += '<br><br>';
                }
                
                if (package.analysis.main_topic) {
                    analysisHtml += `<h6>주요 주제:</h6><p>${package.analysis.main_topic}</p>`;
                }
                
                if (package.analysis.target_audience) {
                    analysisHtml += `<h6>타겟 독자:</h6><p>${package.analysis.target_audience}</p>`;
                }
                
                seoAnalysis.innerHTML = analysisHtml;
            }
            
            // 소셜미디어
            const socialMedia = document.getElementById('socialMedia');
            if (package.social_media) {
                let socialHtml = '';
                
                const platforms = {
                    instagram: { name: 'Instagram', icon: 'fab fa-instagram', color: '#E4405F' },
                    twitter: { name: 'Twitter', icon: 'fab fa-twitter', color: '#1DA1F2' },
                    linkedin: { name: 'LinkedIn', icon: 'fab fa-linkedin', color: '#0077B5' },
                    facebook: { name: 'Facebook', icon: 'fab fa-facebook', color: '#1877F2' }
                };
                
                Object.entries(package.social_media).forEach(([platform, content]) => {
                    if (platforms[platform]) {
                        const platformInfo = platforms[platform];
                        socialHtml += `
                            <div class="social-media-card">
                                <div class="d-flex align-items-center">
                                    <i class="${platformInfo.icon}" style="color: ${platformInfo.color}; font-size: 1.2rem;"></i>
                                    <strong>${platformInfo.name}</strong>
                                </div>
                                <p class="mt-2 mb-0">${content}</p>
                            </div>
                        `;
                    }
                });
                
                socialMedia.innerHTML = socialHtml;
            }
        }
        
        async function downloadPackage() {
            if (!currentPackage) {
                alert('다운로드할 패키지가 없습니다.');
                return;
            }
            
            try {
                const response = await fetch('/api/download', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        package: currentPackage
                    })
                });
                
                if (response.ok) {
                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `seo_package_${new Date().toISOString().slice(0, 19).replace(/:/g, '-')}.zip`;
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);
                } else {
                    alert('다운로드 중 오류가 발생했습니다.');
                }
            } catch (error) {
                alert('다운로드 중 오류가 발생했습니다: ' + error.message);
            }
        }
        
        function resetForm() {
            document.getElementById('conversionForm').reset();
            document.getElementById('resultSection').style.display = 'none';
            currentPackage = null;
        }
    </script>
</body>
</html>
